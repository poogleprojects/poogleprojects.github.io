<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiny World</title>
    <style>
        :root {
            --plains: #8fd14f;
            --forest: #2d6a4f;
            --mountain: #adb5bd;
            --water: #48cae4;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fdf0d5;
            color: #333;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        h1 { color: #d62828; }
        .dashboard {
            display: flex;
            justify-content: space-around;
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }
        .container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
        }
        .board {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            grid-template-rows: repeat(4, 100px);
            gap: 5px;
            background: #444;
            padding: 5px;
            border-radius: 10px;
        }
        .region {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px black;
            transition: transform 0.1s;
        }
        .region:hover { transform: scale(1.05); }
        .plains { background-color: var(--plains); }
        .forest { background-color: var(--forest); }
        .mountain { background-color: var(--mountain); }
        .water { background-color: var(--water); cursor: not-allowed; }
        
        .sidebar {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 300px;
        }
        button {
            background: #003049;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            width: 100%;
        }
        button:hover { background: #d62828; }
        .combo-btn {
            background: #e9ecef;
            color: #333;
            margin-bottom: 10px;
        }
        .combo-btn:hover { background: #dee2e6; color: #333; }
        .log {
            margin-top: 15px;
            font-size: 0.9rem;
            text-align: left;
            height: 150px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 10px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>

    <h1>üåç Tiny World</h1>

    <div class="dashboard">
        <div>üí∞ Coins: <span id="coins">0</span></div>
        <div>üõ°Ô∏è Active Race: <span id="activeRace">None</span></div>
        <div>‚öîÔ∏è Tokens: <span id="tokens">0</span></div>
    </div>

    <div class="container">
        <div class="board" id="board">
            </div>

        <div class="sidebar">
            <div id="drafting-phase">
                <h3>Draft a Combination</h3>
                <div id="draft-list"></div>
            </div>
            
            <div id="action-phase" style="display:none;">
                <h3>Actions</h3>
                <p>Click a region on the board to conquer it. (Costs tokens based on terrain!).</p>
                <button onclick="endTurn()">End Turn & Score</button>
            </div>

            <div class="log" id="log">
                <strong>Game Log:</strong><br>
            </div>
        </div>
    </div>

    <script>
        // --- Game Data ---
        const terrains = [
            { type: 'plains', cost: 2, icon: 'üåæ' },
            { type: 'forest', cost: 2, icon: 'üå≤' },
            { type: 'mountain', cost: 3, icon: '‚õ∞Ô∏è' },
            { type: 'water', cost: 99, icon: 'üåä' } // Unconquerable for this prototype
        ];

        const races = [
            { name: "Orcs üëπ", tokens: 5 },
            { name: "Elves üßù", tokens: 6 },
            { name: "Dwarves üßî", tokens: 3 }
        ];

        const powers = [
            { name: "Flying ü¶Ö", tokens: 5 },
            { name: "Commando üó°Ô∏è", tokens: 4 },
            { name: "Wealthy üíé", tokens: 4 }
        ];

        // --- Game State ---
        let map = [];
        let coins = 0;
        let activeRace = null;
        let tokens = 0;
        let combinations = [];

        // --- Initialization ---
        function initGame() {
            generateMap();
            generateCombinations();
            log("Game started! Please draft a race.");
        }

        function generateMap() {
            const board = document.getElementById('board');
            for (let i = 0; i < 16; i++) {
                // Random terrain favoring land
                let rand = Math.random();
                let terrain = terrains[0]; // Plains
                if (rand > 0.4) terrain = terrains[1]; // Forest
                if (rand > 0.7) terrain = terrains[2]; // Mountain
                if (rand > 0.9) terrain = terrains[3]; // Water

                let cellData = { id: i, terrain: terrain, owner: null };
                map.push(cellData);

                let cell = document.createElement('div');
                cell.className = `region ${terrain.type}`;
                cell.id = `cell-${i}`;
                cell.innerHTML = `${terrain.icon}<br>Cost: ${terrain.cost === 99 ? '-' : terrain.cost}`;
                cell.onclick = () => conquer(i);
                board.appendChild(cell);
            }
        }

        function generateCombinations() {
            const draftList = document.getElementById('draft-list');
            draftList.innerHTML = '';
            
            // Shuffle races and powers
            let shuffledRaces = [...races].sort(() => 0.5 - Math.random());
            let shuffledPowers = [...powers].sort(() => 0.5 - Math.random());

            for (let i = 0; i < 3; i++) {
                let combo = {
                    race: shuffledRaces[i],
                    power: shuffledPowers[i],
                    totalTokens: shuffledRaces[i].tokens + shuffledPowers[i].tokens
                };
                combinations.push(combo);

                let btn = document.createElement('button');
                btn.className = 'combo-btn';
                btn.innerHTML = `${combo.power.name} ${combo.race.name} <br> (${combo.totalTokens} Tokens)`;
                btn.onclick = () => selectCombo(combo);
                draftList.appendChild(btn);
            }
        }

        // --- Core Mechanics ---
        function selectCombo(combo) {
            activeRace = combo;
            tokens = combo.totalTokens;
            updateUI();
            
            document.getElementById('drafting-phase').style.display = 'none';
            document.getElementById('action-phase').style.display = 'block';
            log(`Drafted ${combo.power.name} ${combo.race.name}! You have ${tokens} tokens.`);
        }

        function conquer(cellId) {
            if (!activeRace) return;
            
            let targetCell = map[cellId];
            
            if (targetCell.terrain.type === 'water') {
                log("You cannot conquer water!");
                return;
            }
            if (targetCell.owner === activeRace.race.name) {
                log("You already own this region.");
                return;
            }

            let cost = targetCell.terrain.cost;
            
            if (tokens >= cost) {
                tokens -= cost;
                targetCell.owner = activeRace.race.name;
                
                // Update map UI
                let cellUI = document.getElementById(`cell-${cellId}`);
                cellUI.innerHTML = `${targetCell.terrain.icon}<br>${activeRace.race.name.split(' ')[0]}`;
                cellUI.style.border = "3px solid #d62828";

                log(`Conquered a ${targetCell.terrain.type} for ${cost} tokens.`);
                updateUI();
            } else {
                log(`Not enough tokens! Need ${cost}, but have ${tokens}.`);
            }
        }

        function endTurn() {
            let regionsOwned = map.filter(c => c.owner === activeRace.race.name).length;
            
            if (regionsOwned === 0) {
                log("You didn't conquer anything! No coins earned.");
            } else {
                // Wealthy bonus logic
                let bonus = activeRace.power.name.includes("Wealthy") ? 3 : 0;
                let earned = regionsOwned + bonus;
                coins += earned;
                log(`Turn ended. Scored ${regionsOwned} coins for regions` + (bonus ? ` + 3 Wealthy bonus!` : `.`));
            }
            
            // Reset tokens for next "turn"
            tokens = activeRace.totalTokens; 
            updateUI();
            log("--- New Turn Started ---");
        }

        // --- Utilities ---
        function updateUI() {
            document.getElementById('coins').innerText = coins;
            document.getElementById('activeRace').innerText = activeRace ? `${activeRace.power.name} ${activeRace.race.name}` : "None";
            document.getElementById('tokens').innerText = tokens;
        }

        function log(msg) {
            const logBox = document.getElementById('log');
            logBox.innerHTML += `<div>> ${msg}</div>`;
            logBox.scrollTop = logBox.scrollHeight;
        }

        // Start the game
        initGame();
    </script>
</body>
</html>
